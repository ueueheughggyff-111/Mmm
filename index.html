<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ØªØ¬Ø± ÙƒØ§Ø¯ÙˆÙ‚Ù„ÙŠ | Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --primary: #4338ca; /* Ù„ÙˆÙ† Ù†ÙŠÙ„ÙŠ ÙØ®Ù… */
            --primary-light: #e0e7ff;
            --secondary: #64748b;
            --bg-body: #f8fafc;
            --surface: #ffffff;
            --danger: #ef4444;
            --success: #10b981;
            --warning: #f59e0b;
            --border: #e2e8f0;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --radius: 16px; /* Ø²ÙˆØ§ÙŠØ§ Ø¯Ø§Ø¦Ø±ÙŠØ© Ø¹ØµØ±ÙŠØ© */
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            outline: none;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background-color: var(--bg-body);
            color: #1e293b;
            display: flex;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* --- Sidebar Navigation --- */
        .sidebar {
            width: 280px;
            background: var(--surface);
            border-left: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            padding: 1.5rem;
            position: fixed;
            height: 100vh;
            right: 0;
            top: 0;
            z-index: 100;
            transition: transform 0.3s ease;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 3rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }

        .brand i {
            font-size: 1.8rem;
            color: var(--primary);
        }

        .brand h2 {
            font-size: 1.2rem;
            font-weight: 700;
            color: #0f172a;
        }

        .nav-links {
            list-style: none;
            flex: 1;
        }

        .nav-links li {
            padding: 14px 16px;
            margin-bottom: 8px;
            cursor: pointer;
            border-radius: 12px;
            transition: all 0.3s ease;
            font-weight: 600;
            color: var(--secondary);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .nav-links li i {
            font-size: 1.1rem;
            width: 24px;
            text-align: center;
        }

        .nav-links li:hover {
            background-color: var(--primary-light);
            color: var(--primary);
        }

        .nav-links li.active {
            background-color: var(--primary);
            color: var(--surface);
            box-shadow: 0 4px 12px rgba(67, 56, 202, 0.3);
        }

        .footer-nav {
            margin-top: auto;
        }

        /* --- Main Content area --- */
        .content {
            margin-right: 280px;
            width: 100%;
            padding: 2rem;
            transition: margin 0.3s ease;
        }

        /* --- Top Bar & Header --- */
        header {
            margin-bottom: 2.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        header h1 {
            font-size: 1.8rem;
            font-weight: 700;
        }

        header p {
            color: var(--secondary);
            margin-top: 5px;
        }

        .search-bar {
            background: var(--surface);
            padding: 10px 15px;
            border-radius: 50px;
            border: 1px solid var(--border);
            display: flex;
            align-items: center;
            width: 300px;
            box-shadow: var(--shadow);
        }

        .search-bar input {
            border: none;
            margin-right: 10px;
            width: 100%;
            font-family: 'Cairo', sans-serif;
        }

        /* --- Dashboard Cards (The "Bankak" Look) --- */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .card {
            background: var(--surface);
            padding: 1.5rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            transition: transform 0.2s, box-shadow 0.2s;
            position: relative;
            overflow: hidden;
            border: 1px solid #f1f5f9;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        /* Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ù…Ù„ÙˆÙ†Ø© Ù…Ø«Ù„ Ø§Ù„ØµÙˆØ±Ø© */
        .icon-box {
            width: 55px;
            height: 55px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            margin-bottom: 1rem;
        }

        .bg-purple { background: #f3e8ff; color: #9333ea; }
        .bg-blue { background: #dbeafe; color: #2563eb; }
        .bg-orange { background: #ffedd5; color: #ea580c; }
        .bg-green { background: #dcfce7; color: #16a34a; }
        .bg-red { background: #fee2e2; color: #dc2626; }

        .card h3 {
            font-size: 1rem;
            color: var(--secondary);
            margin-bottom: 0.5rem;
        }

        .card h2 {
            font-size: 1.8rem;
            font-weight: 700;
            color: #0f172a;
        }

        /* --- Forms --- */
        .form-overlay {
            background: var(--surface);
            padding: 2rem;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .hidden { display: none; }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            font-size: 0.9rem;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-family: 'Cairo', sans-serif;
            background: #f8fafc;
            transition: 0.2s;
        }

        input:focus, select:focus {
            border-color: var(--primary);
            background: #fff;
            box-shadow: 0 0 0 3px var(--primary-light);
        }

        /* --- Buttons --- */
        .btn {
            cursor: pointer;
            padding: 10px 24px;
            border: none;
            border-radius: 10px;
            font-weight: 700;
            font-family: 'Cairo', sans-serif;
            transition: 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            justify-content: center;
        }

        .btn-primary { background: var(--primary); color: white; }
        .btn-primary:hover { background: #3730a3; }
        
        .btn-success { background: var(--success); color: white; width: 100%; margin-top: 10px;}
        .btn-success:hover { background: #059669; }

        .btn-danger { 
            background: #fee2e2; color: #dc2626; 
            padding: 6px 12px; font-size: 0.8rem; border-radius: 6px;
        }
        .btn-danger:hover { background: #dc2626; color: white; }

        .btn-outline { background: transparent; border: 1px solid var(--border); color: var(--secondary); }
        .btn-outline:hover { border-color: var(--danger); color: var(--danger); }

        /* --- Tables --- */
        .table-container {
            background: var(--surface);
            border-radius: var(--radius);
            padding: 1rem;
            box-shadow: var(--shadow);
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            white-space: nowrap;
        }

        th {
            background: #f1f5f9;
            padding: 16px;
            font-weight: 700;
            text-align: right;
            color: #475569;
            border-bottom: 2px solid var(--border);
        }

        td {
            padding: 16px;
            border-bottom: 1px solid var(--border);
            color: #334155;
        }

        tr:last-child td { border-bottom: none; }
        tr:hover td { background-color: #f8fafc; }

        .badge {
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
        }
        .badge-red { background: #fee2e2; color: #dc2626; }
        .badge-green { background: #dcfce7; color: #16a34a; }
        .badge-orange { background: #ffedd5; color: #ea580c; }

        /* --- Inventory Grid --- */
        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        .prod-card {
            background: white;
            border-radius: var(--radius);
            padding: 1rem;
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            border: 1px solid var(--border);
        }

        .prod-img {
            width: 100%;
            height: 140px;
            background: #f1f5f9;
            border-radius: 8px;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #cbd5e1;
            font-size: 3rem;
            object-fit: cover;
        }

        /* --- Mobile Responsive --- */
        .mobile-toggle {
            display: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--primary);
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(100%);
                width: 100%;
                z-index: 999;
            }
            .sidebar.show {
                transform: translateX(0);
            }
            .content {
                margin-right: 0;
                padding: 1rem;
            }
            .mobile-toggle {
                display: block;
            }
            .cards-grid {
                grid-template-columns: 1fr;
            }
            header {
                flex-direction: column-reverse;
                align-items: flex-start;
                gap: 1rem;
            }
            .search-bar { width: 100%; }
        }

        /* --- Printing --- */
        @media print {
            .sidebar, .btn, .form-overlay, .search-bar, .mobile-toggle { display: none !important; }
            .content { margin: 0; padding: 0; }
            .page-section { display: block !important; }
            body { background: white; }
            .card, .table-container { box-shadow: none; border: 1px solid #ddd; }
        }

        .page-section { display: none; animation: fadeIn 0.4s; }
        .page-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    </style>
</head>
<body>

    <div style="position: fixed; top: 15px; left: 15px; z-index: 1000;" class="mobile-toggle">
        <i class="fas fa-bars" onclick="toggleSidebar()"></i>
    </div>

    <nav class="sidebar" id="sidebar">
        <div class="brand">
            <i class="fas fa-store"></i>
            <div>
                <h2>Ù…ØªØ¬Ø± ÙƒØ§Ø¯ÙˆÙ‚Ù„ÙŠ</h2>
                <small style="color:var(--secondary)">Ù„Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„ØºØ°Ø§Ø¦ÙŠØ©</small>
            </div>
            <i class="fas fa-times mobile-toggle" style="margin-right: auto;" onclick="toggleSidebar()"></i>
        </div>
        
        <ul class="nav-links">
            <li onclick="showPage('dashboard')" class="active"><i class="fas fa-th-large"></i> Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</li>
            <li onclick="showPage('inventory')"><i class="fas fa-box-open"></i> Ø§Ù„Ù…Ø®Ø²ÙˆÙ† ÙˆØ§Ù„Ø¨Ø¶Ø§Ø¹Ø©</li>
            <li onclick="showPage('debts')"><i class="fas fa-book-open"></i> Ø¯ÙØªØ± Ø§Ù„Ø¯ÙŠÙˆÙ†</li>
            <li onclick="showPage('incoming-money')"><i class="fas fa-wallet"></i> Ø§Ù„ØªØ­ØµÙŠÙ„Ø§Øª (Ù‚Ø±ÙˆØ´)</li>
            <li onclick="showPage('incoming-shipments')"><i class="fas fa-truck-moving"></i> Ø·Ù„Ø¨ÙŠØ§Øª Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†</li>
            <li onclick="showPage('reports')"><i class="fas fa-chart-pie"></i> Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„Ø·Ø¨Ø§Ø¹Ø©</li>
        </ul>

        <div class="footer-nav">
            <button onclick="resetSystem()" class="btn btn-outline" style="width: 100%;">
                <i class="fas fa-trash-alt"></i> ØªØµÙÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…
            </button>
        </div>
    </nav>

    <main class="content">
        
        <section id="dashboard" class="page-section active">
            <header>
                <div>
                    <h1>Ø£Ù‡Ù„Ø§Ù‹ Ø¨ÙƒØŒ Ø§Ù„Ù…Ø¯ÙŠØ± ğŸ‘‹</h1>
                    <p>Ø¥Ù„ÙŠÙƒ Ù…Ù„Ø®Øµ Ø³Ø±ÙŠØ¹ Ù„Ø­Ø±ÙƒØ© "Ù…ØªØ¬Ø± ÙƒØ§Ø¯ÙˆÙ‚Ù„ÙŠ" Ø§Ù„ÙŠÙˆÙ…</p>
                </div>
                </header>
            
            <div class="cards-grid">
                <div class="card">
                    <div class="icon-box bg-purple">
                        <i class="fas fa-hand-holding-usd"></i>
                    </div>
                    <h3>Ù…Ø·Ù„ÙˆØ¨ Ø³Ø¯Ø§Ø¯Ù‡Ø§ (Ø¹Ù„ÙŠÙƒ)</h3>
                    <h2 id="dash-total-owed">0</h2>
                </div>

                <div class="card">
                    <div class="icon-box bg-green">
                        <i class="fas fa-coins"></i>
                    </div>
                    <h3>Ø¯ÙŠÙˆÙ† ÙÙŠ Ø§Ù„Ø³ÙˆÙ‚ (Ù„Ùƒ)</h3>
                    <h2 id="dash-total-credit">0</h2>
                </div>

                <div class="card">
                    <div class="icon-box bg-orange">
                        <i class="fas fa-cubes"></i>
                    </div>
                    <h3>Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ø§Ù„ÙƒÙ„ÙŠØ©</h3>
                    <h2 id="dash-inv-value">0</h2>
                </div>

                <div class="card">
                    <div class="icon-box bg-blue">
                        <i class="fas fa-money-bill-wave"></i>
                    </div>
                    <h3>ØªØ­ØµÙŠÙ„Ø§Øª Ù…ØªÙˆÙ‚Ø¹Ø©</h3>
                    <h2 id="dash-incoming-money">0</h2>
                </div>
            </div>

            <div class="card" style="border-right: 5px solid var(--danger);">
                <div style="display:flex; align-items:center; gap:10px;">
                    <i class="fas fa-bell" style="color:var(--danger); font-size:1.5rem;"></i>
                    <div>
                        <h3>ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ù‡Ø§Ù…Ø©</h3>
                        <p id="alert-msg">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨Ø¶Ø§Ø¹Ø© Ø±Ø§ÙƒØ¯Ø© Ø£Ùˆ Ø¯ÙŠÙˆÙ† Ù…ØªØ£Ø®Ø±Ø© Ø­Ø§Ù„ÙŠØ§Ù‹.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="inventory" class="page-section">
            <header>
                <div>
                    <h1>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</h1>
                    <p>ØªØ§Ø¨Ø¹ Ø­Ø±ÙƒØ© Ø§Ù„Ø¨Ø¶Ø§Ø¹Ø© ÙˆØ§Ù„ÙƒÙ…ÙŠØ§Øª</p>
                </div>
                <button onclick="toggleForm('inv-form')" class="btn btn-primary"><i class="fas fa-plus"></i> Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬</button>
            </header>

            <div id="inv-form" class="form-overlay hidden">
                <h3 style="margin-bottom:1rem">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ø¬Ø¯ÙŠØ¯</h3>
                <form onsubmit="handleInvSubmit(event)">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬</label>
                            <input type="text" id="inv-name" required placeholder="Ù…Ø«Ø§Ù„: Ø³ÙƒØ±ØŒ Ø¯Ù‚ÙŠÙ‚...">
                        </div>
                        <div class="form-group">
                            <label>Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…ØªÙˆÙØ±Ø©</label>
                            <input type="number" id="inv-qty" required>
                        </div>
                        <div class="form-group">
                            <label>Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹ (Ù‚Ø·Ø¹Ø©)</label>
                            <input type="number" id="inv-price" required>
                        </div>
                        <div class="form-group">
                            <label>Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ù†ØªØ¬</label>
                            <select id="inv-status">
                                <option value="active">Ù†Ø´Ø· (Ø³Ø±ÙŠØ¹ Ø§Ù„Ø¯ÙˆØ±Ø§Ù†)</option>
                                <option value="stuck">Ø±Ø§ÙƒØ¯ (Ø¨Ø·ÙŠØ¡)</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                        <input type="text" id="inv-img" placeholder="https://...">
                    </div>
                    <button type="submit" class="btn btn-success">Ø­ÙØ¸ Ø§Ù„Ù…Ù†ØªØ¬ ÙÙŠ Ø§Ù„Ù…Ø®Ø²Ù†</button>
                </form>
            </div>

            <div class="search-bar" style="width: 100%; margin-bottom: 20px;">
                <input type="text" id="inv-search" onkeyup="filterInventory()" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬...">
                <i class="fas fa-search"></i>
            </div>

            <div id="inventory-grid" class="inventory-grid">
                </div>
        </section>

        <section id="debts" class="page-section">
            <header>
                <div>
                    <h1>Ø¯ÙØªØ± Ø§Ù„Ø¯ÙŠÙˆÙ†</h1>
                    <p>Ø³Ø¬Ù„ Ù…Ø§ Ù„Ùƒ ÙˆÙ…Ø§ Ø¹Ù„ÙŠÙƒ Ø¨Ø¯Ù‚Ø©</p>
                </div>
                <button onclick="toggleForm('debt-form')" class="btn btn-primary"><i class="fas fa-plus"></i> ØªØ³Ø¬ÙŠÙ„ Ø¯ÙŠÙ†</button>
            </header>

            <div id="debt-form" class="form-overlay hidden">
                <form onsubmit="handleDebtSubmit(event)">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Ø§Ø³Ù… Ø§Ù„Ø´Ø®Øµ / Ø§Ù„Ø¬Ù‡Ø©</label>
                            <input type="text" id="debt-person" required>
                        </div>
                        <div class="form-group">
                            <label>Ù†ÙˆØ¹ Ø§Ù„Ù‚ÙŠØ¯</label>
                            <select id="debt-type">
                                <option value="liac">Ø¹Ù„ÙŠÙ‡ (Ù„ÙŠ ÙÙ„ÙˆØ³)</option>
                                <option value="owed">Ù„Ù‡ (Ø¹Ù„ÙŠ ÙÙ„ÙˆØ³)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Ø§Ù„Ù…Ø¨Ù„Øº</label>
                            <input type="number" id="debt-amount" required>
                        </div>
                        <div class="form-group">
                            <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹</label>
                            <input type="date" id="debt-date" required>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-success">Ø­ÙØ¸ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</button>
                </form>
            </div>

            <div class="table-container">
                <table id="debts-table">
                    <thead>
                        <tr>
                            <th>Ø§Ù„Ø§Ø³Ù…</th>
                            <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                            <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
                            <th>Ø§Ù„Ù…ÙˆØ¹Ø¯</th>
                            <th>Ù…Ù„Ø§Ø­Ø¸Ø©</th>
                            <th>ØªØ­ÙƒÙ…</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </section>

        <section id="incoming-money" class="page-section">
            <header>
                <h1>Ø§Ù„ØªØ­ØµÙŠÙ„Ø§Øª ÙˆØ§Ù„Ø¯ÙØ¹Ø§Øª Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©</h1>
                <button onclick="toggleForm('money-form')" class="btn btn-primary"><i class="fas fa-plus"></i> Ø¥Ø¶Ø§ÙØ© Ø¯ÙØ¹Ø©</button>
            </header>

            <div id="money-form" class="form-overlay hidden">
                <form onsubmit="handleMoneySubmit(event)">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Ø§Ù„Ù…ØµØ¯Ø±</label>
                            <input type="text" id="money-source" required>
                        </div>
                        <div class="form-group">
                            <label>Ø§Ù„Ù…Ø¨Ù„Øº</label>
                            <input type="number" id="money-amount" required>
                        </div>
                        <div class="form-group">
                            <label>Ø§Ù„Ø­Ø§Ù„Ø©</label>
                            <select id="money-status">
                                <option value="pending">ÙÙŠ Ø§Ù„Ø·Ø±ÙŠÙ‚</option>
                                <option value="received">ØªÙ… Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…</option>
                            </select>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-success">Ø­ÙØ¸</button>
                </form>
            </div>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Ø§Ù„Ø¬Ù‡Ø©</th>
                            <th>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªÙˆÙ‚Ø¹</th>
                            <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                            <th>Ø¥Ø¬Ø±Ø§Ø¡</th>
                        </tr>
                    </thead>
                    <tbody id="money-table-body"></tbody>
                </table>
            </div>
        </section>

        <section id="incoming-shipments" class="page-section">
            <header>
                <h1>Ø·Ù„Ø¨ÙŠØ§Øª Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ† (Ø§Ù„ÙˆØ§Ø±Ø¯)</h1>
                <button onclick="toggleForm('ship-form')" class="btn btn-primary"><i class="fas fa-plus"></i> Ø·Ù„Ø¨ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©</button>
            </header>

            <div id="ship-form" class="form-overlay hidden">
                <form onsubmit="handleShipSubmit(event)">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ±Ø¯</label>
                            <input type="text" id="ship-supplier" required>
                        </div>
                        <div class="form-group">
                            <label>Ù†ÙˆØ¹ Ø§Ù„Ø¨Ø¶Ø§Ø¹Ø©</label>
                            <input type="text" id="ship-type" required>
                        </div>
                        <div class="form-group">
                            <label>Ø­Ø§Ù„Ø© Ø§Ù„Ø´Ø­Ù†</label>
                            <select id="ship-status">
                                <option value="processing">ØªØ¬Ù‡ÙŠØ²</option>
                                <option value="shipped">ØªÙ… Ø§Ù„Ø´Ø­Ù†</option>
                                <option value="customs">ØªØ®Ù„ÙŠØµ Ø¬Ù…Ø±ÙƒÙŠ</option>
                                <option value="arrived">ÙÙŠ Ø§Ù„Ù…Ø®Ø²Ù†</option>
                            </select>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-success">Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨ÙŠØ©</button>
                </form>
            </div>

            <div class="cards-grid" id="shipments-grid"></div>
        </section>

        <section id="reports" class="page-section">
            <header>
                <h1>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠØ©</h1>
                </header>

            <div style="background: white; padding: 2rem; border-radius: 16px; border: 1px solid var(--border);">
                <div style="text-align: center; margin-bottom: 2rem;">
                    <h2>Ù…ØªØ¬Ø± ÙƒØ§Ø¯ÙˆÙ‚Ù„ÙŠ Ù„Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„ØºØ°Ø§Ø¦ÙŠØ©</h2>
                    <p>ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ© ÙˆØ§Ù„Ù…Ø®Ø²ÙˆÙ†ÙŠØ©</p>
                    <small id="report-date"></small>
                </div>

                <div class="cards-grid">
                    <div class="card" style="background: #f8fafc; border:none;">
                        <h3>ØµØ§ÙÙŠ Ø§Ù„Ù…ÙˆÙ‚Ù Ø§Ù„Ù…Ø§Ù„ÙŠ</h3>
                        <p style="font-size:0.9rem; color:#666">Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† Ù…Ø§ Ù„Ùƒ ÙˆÙ…Ø§ Ø¹Ù„ÙŠÙƒ</p>
                        <h2 id="report-net-debt" style="direction: ltr;">0</h2>
                    </div>
                    <div class="card" style="background: #f8fafc; border:none;">
                        <h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„ ÙÙŠ Ø§Ù„Ø¨Ø¶Ø§Ø¹Ø©</h3>
                        <p style="font-size:0.9rem; color:#666">Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ø¨Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹</p>
                        <h2 id="report-inv-total">0</h2>
                    </div>
                </div>

                <h3 style="margin-top: 2rem; border-bottom: 1px solid #eee; padding-bottom: 10px;">âš ï¸ Ø¯ÙŠÙˆÙ† Ù…ØªØ£Ø®Ø±Ø© Ø§Ù„Ø³Ø¯Ø§Ø¯ (Ù„Ùƒ)</h3>
                <ul id="report-late-list" style="margin-top: 1rem; list-style: none; color: var(--danger);"></ul>
            </div>
        </section>

    </main>

    <script>
        // --- ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ---
        let data = {
            debts: [],
            inventory: [],
            incomingMoney: [],
            incomingShipments: []
        };

        document.addEventListener('DOMContentLoaded', () => {
            loadData();
            renderAll();
            document.getElementById('report-date').innerText = new Date().toLocaleDateString('ar-EG');
        });

        // --- ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ---
        function loadData() {
            const saved = localStorage.getItem('kadugliAppData');
            if (saved) data = JSON.parse(saved);
        }

        function saveData() {
            localStorage.setItem('kadugliAppData', JSON.stringify(data));
            renderAll();
        }

        function resetSystem() {
            if(confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„Ù…ØµÙ†Ø¹ØŸ')) {
                localStorage.removeItem('kadugliAppData');
                location.reload();
            }
        }

        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('show');
        }

        function showPage(pageId) {
            document.querySelectorAll('.page-section').forEach(sec => sec.classList.remove('active'));
            document.querySelectorAll('.nav-links li').forEach(li => li.classList.remove('active'));
            
            document.getElementById(pageId).classList.add('active');
            
            // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø²Ø± Ø§Ù„Ù†Ø´Ø· ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
            const navItems = document.querySelectorAll('.nav-links li');
            const pages = ['dashboard', 'inventory', 'debts', 'incoming-money', 'incoming-shipments', 'reports'];
            const idx = pages.indexOf(pageId);
            if(idx >= 0 && navItems[idx]) navItems[idx].classList.add('active');

            if(window.innerWidth <= 768) toggleSidebar(); // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙÙŠ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„
        }

        function toggleForm(id) {
            const el = document.getElementById(id);
            if(el.classList.contains('hidden')) {
                el.classList.remove('hidden');
            } else {
                el.classList.add('hidden');
            }
        }

        function formatCurrency(num) {
            return Number(num).toLocaleString('en-US') + ' Ø¬.Ø³';
        }

        // --- Ø§Ù„Ø±ÙŠÙ†Ø¯Ø± ÙˆØ§Ù„Ø¹Ø±Ø¶ (Rendering) ---

        function renderAll() {
            renderDashboard();
            renderInventory();
            renderDebts();
            renderMoney();
            renderShipments();
            renderReports();
        }

        function renderDashboard() {
            // Ø­Ø³Ø§Ø¨Ø§Øª
            const owed = data.debts.filter(d => d.type === 'owed').reduce((s, d) => s + +d.amount, 0);
            const credit = data.debts.filter(d => d.type === 'liac').reduce((s, d) => s + +d.amount, 0);
            const invVal = data.inventory.reduce((s, i) => s + (+i.price * +i.qty), 0);
            const incoming = data.incomingMoney.filter(m => m.status === 'pending').reduce((s, m) => s + +m.amount, 0);
            const stuckItems = data.inventory.filter(i => i.status === 'stuck').length;

            // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            document.getElementById('dash-total-owed').innerText = formatCurrency(owed);
            document.getElementById('dash-total-credit').innerText = formatCurrency(credit);
            document.getElementById('dash-inv-value').innerText = formatCurrency(invVal);
            document.getElementById('dash-incoming-money').innerText = formatCurrency(incoming);

            // Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª
            const alertBox = document.getElementById('alert-msg');
            if (stuckItems > 0) {
                alertBox.innerHTML = `ÙŠÙˆØ¬Ø¯ Ù„Ø¯ÙŠÙƒ <b>${stuckItems}</b> Ø£ØµÙ†Ø§Ù Ø±Ø§ÙƒØ¯Ø© ÙÙŠ Ø§Ù„Ù…Ø®Ø²Ù†ØŒ Ø­Ø§ÙˆÙ„ Ø¹Ù…Ù„ ØªØ®ÙÙŠØ¶Ø§Øª Ù„ØªØµØ±ÙŠÙÙ‡Ø§.`;
            } else {
                alertBox.innerHTML = "Ø¹Ù…Ù„ Ù…Ù…ØªØ§Ø²! Ø§Ù„Ù…Ø®Ø²Ù† ÙŠØªØ­Ø±Ùƒ Ø¨Ø´ÙƒÙ„ Ø¬ÙŠØ¯ ÙˆÙ„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø´Ø§ÙƒÙ„ Ø¸Ø§Ù‡Ø±Ø©.";
            }
        }

        // --- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ† ---
        function handleInvSubmit(e) {
            e.preventDefault();
            data.inventory.push({
                id: Date.now(),
                name: document.getElementById('inv-name').value,
                qty: document.getElementById('inv-qty').value,
                price: document.getElementById('inv-price').value,
                status: document.getElementById('inv-status').value,
                img: document.getElementById('inv-img').value
            });
            saveData();
            e.target.reset();
            toggleForm('inv-form');
            alert('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­');
        }

        function renderInventory(filterText = '') {
            const grid = document.getElementById('inventory-grid');
            grid.innerHTML = '';
            
            const items = data.inventory.filter(i => i.name.includes(filterText));

            items.forEach(item => {
                const isStuck = item.status === 'stuck';
                const imgSrc = item.img || ''; 
                
                // ØµÙˆØ±Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ÙÙŠ Ø­Ø§Ù„Ø© Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø±Ø§Ø¨Ø·
                const imgDisplay = imgSrc ? 
                    `<img src="${imgSrc}" style="width:100%; height:100%; object-fit:cover; border-radius:8px;">` : 
                    `<i class="fas fa-box" style="font-size:3rem; color:#cbd5e1"></i>`;

                grid.innerHTML += `
                    <div class="prod-card" style="${isStuck ? 'border:2px solid var(--warning);' : ''}">
                        <div class="prod-img">${imgDisplay}</div>
                        <h3 style="font-weight:700; font-size:1.1rem">${item.name}</h3>
                        <div style="display:flex; justify-content:space-between; margin-top:10px;">
                            <span>Ø§Ù„ÙƒÙ…ÙŠØ©: <b>${item.qty}</b></span>
                            <span style="color:var(--primary)">${item.price} Ø¬.Ø³</span>
                        </div>
                        <div style="margin-top:10px;">
                            ${isStuck ? '<span class="badge badge-orange">âš ï¸ Ø±Ø§ÙƒØ¯</span>' : '<span class="badge badge-green">Ù†Ø´Ø·</span>'}
                        </div>
                        <button class="btn btn-danger" style="margin-top:15px;" onclick="deleteItem('inventory', ${item.id})">
                            <i class="fas fa-trash"></i> Ø­Ø°Ù
                        </button>
                    </div>
                `;
            });
            if(items.length === 0) grid.innerHTML = '<p style="text-align:center; width:100%; color:#999">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ù…Ø·Ø§Ø¨Ù‚Ø©</p>';
        }

        function filterInventory() {
            const txt = document.getElementById('inv-search').value;
            renderInventory(txt);
        }

        // --- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯ÙŠÙˆÙ† ---
        function handleDebtSubmit(e) {
            e.preventDefault();
            data.debts.push({
                id: Date.now(),
                person: document.getElementById('debt-person').value,
                type: document.getElementById('debt-type').value,
                amount: document.getElementById('debt-amount').value,
                date: document.getElementById('debt-date').value
            });
            saveData();
            e.target.reset();
            toggleForm('debt-form');
        }

        function renderDebts() {
            const tbody = document.querySelector('#debts-table tbody');
            tbody.innerHTML = '';
            const sorted = data.debts.sort((a,b) => new Date(a.date) - new Date(b.date));

            sorted.forEach(d => {
                const isOwedToMe = d.type === 'liac';
                const badgeClass = d.type === 'owed' ? 'badge-red' : 'badge-green';
                const typeText = d.type === 'owed' ? 'Ù…Ø·Ù„ÙˆØ¨ Ù…Ù†Ù‡ (Ø¹Ù„ÙŠ)' : 'Ù…Ø³ØªØ­Ù‚ Ù„ÙŠ (Ø¹Ù„ÙŠÙ‡)';
                
                // ÙØ­Øµ Ø§Ù„ØªØ£Ø®ÙŠØ±
                const isLate = new Date(d.date) < new Date() && isOwedToMe;

                tbody.innerHTML += `
                    <tr>
                        <td style="font-weight:bold">${d.person}</td>
                        <td><span class="badge ${badgeClass}">${typeText}</span></td>
                        <td>${formatCurrency(d.amount)}</td>
                        <td>${d.date}</td>
                        <td>${isLate ? '<span style="color:red; font-weight:bold"><i class="fas fa-exclamation-circle"></i> Ù…ØªØ£Ø®Ø±</span>' : '-'}</td>
                        <td><button class="btn btn-danger" onclick="deleteItem('debts', ${d.id})"><i class="fas fa-times"></i></button></td>
                    </tr>
                `;
            });
        }

        // --- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ­ØµÙŠÙ„Ø§Øª ---
        function handleMoneySubmit(e) {
            e.preventDefault();
            data.incomingMoney.push({
                id: Date.now(),
                source: document.getElementById('money-source').value,
                amount: document.getElementById('money-amount').value,
                status: document.getElementById('money-status').value
            });
            saveData();
            e.target.reset();
            toggleForm('money-form');
        }

        function renderMoney() {
            const tbody = document.getElementById('money-table-body');
            tbody.innerHTML = '';
            data.incomingMoney.forEach(m => {
                const stText = m.status === 'received' ? '<span class="badge badge-green">ØªÙ… Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…</span>' : '<span class="badge badge-orange">ÙÙŠ Ø§Ù„Ø·Ø±ÙŠÙ‚</span>';
                tbody.innerHTML += `
                    <tr>
                        <td>${m.source}</td>
                        <td>${formatCurrency(m.amount)}</td>
                        <td>${stText}</td>
                        <td><button class="btn btn-danger" onclick="deleteItem('incomingMoney', ${m.id})"><i class="fas fa-times"></i></button></td>
                    </tr>
                `;
            });
        }

        // --- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø´Ø­Ù†Ø§Øª ---
        function handleShipSubmit(e) {
            e.preventDefault();
            data.incomingShipments.push({
                id: Date.now(),
                supplier: document.getElementById('ship-supplier').value,
                type: document.getElementById('ship-type').value,
                status: document.getElementById('ship-status').value
            });
            saveData();
            e.target.reset();
            toggleForm('ship-form');
        }

        function renderShipments() {
            const grid = document.getElementById('shipments-grid');
            grid.innerHTML = '';
            const statusMap = {
                'processing': {text: 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ¬Ù‡ÙŠØ²', icon: 'fa-box', color: 'orange'},
                'shipped': {text: 'ØªÙ… Ø§Ù„Ø´Ø­Ù†', icon: 'fa-shipping-fast', color: 'blue'},
                'customs': {text: 'Ø¬Ù…Ø§Ø±Ùƒ', icon: 'fa-file-signature', color: 'purple'},
                'arrived': {text: 'ÙˆØµÙ„Øª Ø§Ù„Ù…Ø®Ø²Ù†', icon: 'fa-check-circle', color: 'green'}
            };

            data.incomingShipments.forEach(s => {
                const st = statusMap[s.status];
                grid.innerHTML += `
                    <div class="card">
                        <div class="icon-box" style="background:var(--primary-light); color:var(--primary)">
                            <i class="fas ${st.icon}"></i>
                        </div>
                        <h3>${s.type}</h3>
                        <p style="color:#666">Ø§Ù„Ù…ÙˆØ±Ø¯: <b>${s.supplier}</b></p>
                        <hr style="margin:10px 0; border-color:#eee">
                        <div style="display:flex; justify-content:space-between; align-items:center">
                            <span style="color:${st.color}; font-weight:bold">${st.text}</span>
                            <button class="btn btn-danger" onclick="deleteItem('incomingShipments', ${s.id})"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                `;
            });
        }

        // --- Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ---
        function renderReports() {
            const myDebts = data.debts.filter(d => d.type === 'owed').reduce((s, d) => s + +d.amount, 0);
            const peopleDebts = data.debts.filter(d => d.type === 'liac').reduce((s, d) => s + +d.amount, 0);
            const net = peopleDebts - myDebts;
            const invVal = data.inventory.reduce((s, i) => s + (+i.price * +i.qty), 0);

            const netEl = document.getElementById('report-net-debt');
            netEl.innerText = formatCurrency(net);
            netEl.style.color = net >= 0 ? 'var(--success)' : 'var(--danger)';

            document.getElementById('report-inv-total').innerText = formatCurrency(invVal);

            // Ø§Ù„Ù…ØªØ£Ø®Ø±Ø§Øª
            const list = document.getElementById('report-late-list');
            list.innerHTML = '';
            const today = new Date();
            let hasLate = false;
            data.debts.forEach(d => {
                if(d.type === 'liac' && new Date(d.date) < today) {
                    hasLate = true;
                    list.innerHTML += `<li><i class="fas fa-exclamation-triangle"></i> ${d.person} - Ù…Ø¨Ù„Øº: ${formatCurrency(d.amount)} (ÙƒØ§Ù† Ù…ØªÙˆÙ‚Ø¹: ${d.date})</li>`;
                }
            });
            if(!hasLate) list.innerHTML = '<li style="color:green"><i class="fas fa-check-circle"></i> Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡ØŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¯ÙŠÙˆÙ† Ù…ØªØ£Ø®Ø±Ø©.</li>';
        }

        function deleteItem(arr, id) {
            if(confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø­Ø°ÙØŸ')) {
                data[arr] = data[arr].filter(i => i.id !== id);
                saveData();
            }
        }
    </script>
</body>
</html>